<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Chat Webhook</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://unpkg.com/preline/dist/preline.js"></script>
  <style>
    /* Loading screen */
    #loadingScreen {
      position: fixed;
      inset: 0;
      background: black;
      color: white;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      z-index: 50;
    }
    /* Loading bar at top */
    #loadingBar {
      position: fixed;
      top: 0;
      left: 0;
      height: 4px;
      background: red;
      width: 0;
      z-index: 60;
      transition: width 5s linear;
    }
    /* Toasts */
    .toast {
      background: #1f2937;
      color: white;
      padding: 0.75rem 1rem;
      border-radius: 0.5rem;
      margin-top: 0.5rem;
      display: flex;
      align-items: center;
      gap: 0.5rem;
      box-shadow: 0 4px 6px rgba(0,0,0,0.3);
      transform: translateX(120%);
      opacity: 0;
      transition: all 0.4s ease;
    }
    .toast.show {
      transform: translateX(0);
      opacity: 1;
    }
    #toastContainer {
      position: fixed;
      bottom: 1rem;
      right: 1rem;
      z-index: 100;
      display: flex;
      flex-direction: column;
      align-items: flex-end;
    }
  </style>
</head>
<body class="bg-gray-900 text-white">

  <!-- Loading -->
  <div id="loadingScreen">
    <div id="loadingBar"></div>
    <h1 class="text-3xl font-bold">Loading...</h1>
  </div>

  <!-- Main content -->
  <div id="mainContent" class="hidden p-6">
    <h1 class="text-2xl font-bold mb-4">Webhook Manager</h1>
    <form id="webhookForm" class="space-y-3">
      <input id="webhookInput" type="text" placeholder="Enter webhook URL"
        class="w-full px-3 py-2 rounded bg-gray-800 border border-gray-600 text-white">
      <button type="submit" class="bg-blue-600 px-4 py-2 rounded hover:bg-blue-500">Save Webhook</button>
    </form>

    <div class="mt-6">
      <h2 class="text-xl font-semibold mb-2">Saved Webhooks</h2>
      <ul id="webhookList" class="space-y-2"></ul>
    </div>
  </div>

  <!-- Toast container -->
  <div id="toastContainer"></div>

<script>
  // --- LOADING SCREEN ---
  window.addEventListener("load", () => {
    const bar = document.getElementById("loadingBar");
    setTimeout(() => { bar.style.width = "100%"; }, 50); // animate bar
    setTimeout(() => {
      document.getElementById("loadingScreen").style.display = "none";
      document.getElementById("mainContent").classList.remove("hidden");
    }, 5000);
  });

  // --- COOKIES ---
  function getCookies(name) {
    let matches = document.cookie.match(new RegExp(
      "(?:^|; )" + name.replace(/([.$?*|{}()\\[\\]\\\\\\/\\+^])/g, '\\$1') + "=([^;]*)"
    ));
    return matches ? decodeURIComponent(matches[1]) : "";
  }
  function setCookies(name, value, days) {
    let d = new Date();
    d.setTime(d.getTime() + (days*24*60*60*1000));
    document.cookie = `${name}=${encodeURIComponent(value)}; expires=${d.toUTCString()}; path=/`;
  }

  // --- WEBHOOK FORM ---
  const webhookForm = document.getElementById("webhookForm");
  const webhookInput = document.getElementById("webhookInput");
  const webhookList = document.getElementById("webhookList");

  function loadWebhooks() {
    let saved = getCookies("webhooks");
    let arr = saved ? JSON.parse(saved) : [];
    webhookList.innerHTML = "";
    arr.forEach((url, i) => {
      let li = document.createElement("li");
      li.className = "flex justify-between items-center bg-gray-800 p-2 rounded";
      li.innerHTML = `<span>${url}</span>
        <button class="text-red-500" onclick="removeWebhook(${i})">Remove</button>`;
      webhookList.appendChild(li);
    });
  }

  function removeWebhook(i) {
    let saved = getCookies("webhooks");
    let arr = saved ? JSON.parse(saved) : [];
    arr.splice(i, 1);
    setCookies("webhooks", JSON.stringify(arr), 30);
    loadWebhooks();
    showToast("Webhook removed", "success");
  }

  webhookForm.addEventListener("submit", e => {
    e.preventDefault();
    let url = webhookInput.value.trim();
    if(!url) return;
    let saved = getCookies("webhooks");
    let arr = saved ? JSON.parse(saved) : [];
    arr.push(url);
    setCookies("webhooks", JSON.stringify(arr), 30);
    webhookInput.value = "";
    loadWebhooks();
    showToast("Webhook saved!", "success");
  });

  // --- TOASTS ---
  function showToast(message, type="success") {
    const container = document.getElementById("toastContainer");
    const toast = document.createElement("div");
    toast.className = "toast";
    toast.innerHTML = `
      <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5 text-green-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/>
      </svg>
      <span>${message}</span>
    `;
    container.prepend(toast);
    setTimeout(()=>toast.classList.add("show"),100);
    setTimeout(()=>{
      toast.classList.remove("show");
      setTimeout(()=>toast.remove(),400);
    },3000);
  }

  loadWebhooks();
</script>
</body>
</html>
