<!DOCTYPE html>
<html lang="en" class="dark">
<head>
  <meta charset="UTF-8">
  <title>Chat Webhook</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    .page { display: none; }
    .active { display: block; }
    .toast {
      position: fixed;
      bottom: 1rem;
      right: 1rem;
      padding: 1rem 1.5rem;
      border-radius: 0.5rem;
      color: white;
      min-width: 200px;
      transform: translateX(120%);
      animation: slideIn 0.4s forwards;
      margin-top: 0.5rem;
    }
    @keyframes slideIn {
      from { transform: translateX(120%); }
      to { transform: translateX(0); }
    }
  </style>
</head>
<body class="bg-gray-900 text-white min-h-screen flex flex-col">

  <!-- Navbar -->
  <nav class="flex justify-between p-4 bg-gray-800">
    <div class="font-bold">Chat Webhook</div>
    <div>
      <button onclick="showPage('manager')" class="px-3 py-1 bg-gray-700 rounded">Webhooks</button>
      <button onclick="showPage('sender')" class="px-3 py-1 bg-gray-700 rounded">Send</button>
      <button onclick="toggleDarkMode()" class="px-3 py-1 bg-gray-700 rounded">ðŸŒ™</button>
    </div>
  </nav>

  <!-- Pages -->
  <main class="flex-grow p-6">

    <!-- Webhook Manager -->
    <section id="manager" class="page active">
      <h2 class="text-2xl mb-4">Webhook Manager</h2>
      <form onsubmit="addWebhook(event)" class="mb-4 flex gap-2">
        <input id="webhookInput" type="url" placeholder="Enter Webhook URL" class="flex-grow px-3 py-2 rounded text-black">
        <button class="bg-blue-600 px-4 py-2 rounded">Add</button>
      </form>
      <ul id="webhookList" class="space-y-2"></ul>
    </section>

    <!-- Message Sender -->
    <section id="sender" class="page">
      <h2 class="text-2xl mb-4">Send Message</h2>
      <form onsubmit="sendMessage(event)" class="space-y-3">
        <select id="webhookSelect" class="w-full px-3 py-2 rounded text-black"></select>
        <textarea id="messageInput" rows="4" placeholder="Type your message..." class="w-full px-3 py-2 rounded text-black"></textarea>
        <button class="bg-green-600 px-4 py-2 rounded">Send</button>
      </form>
    </section>

  </main>

  <!-- Toast Container -->
  <div id="toastContainer"></div>

  <script>
    // Page switching
    function showPage(page) {
      document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
      document.getElementById(page).classList.add('active');
    }

    // Dark mode
    function toggleDarkMode() {
      document.documentElement.classList.toggle('dark');
      localStorage.setItem('dark', document.documentElement.classList.contains('dark'));
    }
    if (localStorage.getItem('dark') === 'false') {
      document.documentElement.classList.remove('dark');
    }

    // Webhook Manager
    let webhooks = JSON.parse(localStorage.getItem('webhooks') || '[]');
    const listEl = document.getElementById('webhookList');
    const selectEl = document.getElementById('webhookSelect');

    function renderWebhooks() {
      listEl.innerHTML = '';
      selectEl.innerHTML = '';
      webhooks.forEach((url, idx) => {
        let li = document.createElement('li');
        li.className = "bg-gray-700 p-3 rounded flex justify-between";
        li.innerHTML = `
          <span>${url}</span>
          <div>
            <button onclick="editWebhook(${idx})" class="px-2 bg-yellow-600 rounded mr-1">Edit</button>
            <button onclick="removeWebhook(${idx})" class="px-2 bg-red-600 rounded">Delete</button>
          </div>`;
        listEl.appendChild(li);

        let opt = document.createElement('option');
        opt.value = url;
        opt.textContent = url;
        selectEl.appendChild(opt);
      });
      localStorage.setItem('webhooks', JSON.stringify(webhooks));
    }

    function addWebhook(e) {
      e.preventDefault();
      const val = document.getElementById('webhookInput').value;
      if (!val) return;
      webhooks.push(val);
      document.getElementById('webhookInput').value = '';
      renderWebhooks();
      showToast('Webhook added!', 'success');
    }

    function removeWebhook(idx) {
      webhooks.splice(idx, 1);
      renderWebhooks();
      showToast('Webhook removed!', 'error');
    }

    function editWebhook(idx) {
      const newUrl = prompt("Edit Webhook URL:", webhooks[idx]);
      if (newUrl) {
        webhooks[idx] = newUrl;
        renderWebhooks();
        showToast('Webhook updated!', 'info');
      }
    }

    // Send Message
    function sendMessage(e) {
      e.preventDefault();
      const url = selectEl.value;
      const msg = document.getElementById('messageInput').value;
      if (!url || !msg) return showToast("Please select a webhook and enter a message", "error");

      // Example only (disabled request)
      showToast(`Message sent to ${url}`, "success");
      document.getElementById('messageInput').value = '';
    }

    // Toast System
    function showToast(msg, type) {
      const colors = {
        success: "bg-green-600",
        error: "bg-red-600",
        info: "bg-blue-600"
      };
      const toast = document.createElement('div');
      toast.className = `toast ${colors[type]}`;
      toast.textContent = msg;
      document.getElementById('toastContainer').appendChild(toast);
      setTimeout(() => toast.remove(), 3000);
    }

    renderWebhooks();
  </script>
</body>
</html>
