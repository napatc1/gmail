<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Chat Webhook</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://cdn.jsdelivr.net/npm/preline/dist/preline.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/quill@1.3.7/dist/quill.min.js"></script>
  <link href="https://cdn.jsdelivr.net/npm/quill@1.3.7/dist/quill.snow.css" rel="stylesheet">
  <style>
    body { background:#111827; color:#f3f4f6; margin:0; font-family:sans-serif; }
    .ql-toolbar, .ql-container { background:#1f2937; border:none!important; }
    .ql-editor { min-height:150px; color:white; }
    .tab { display:none; }
    .tab.active { display:block; }

    /* Splash full screen */
    #splash {
      position:fixed; top:0; left:0; width:100%; height:100%;
      background:#111827; z-index:50; display:flex; flex-direction:column; justify-center; align-items:center;
    }
    #splash h1 { font-size:2rem; margin-bottom:1rem; color:white; }
    .loading-bar {
      position:absolute; top:0; left:0; height:4px; width:100%;
      background:transparent; overflow:hidden;
    }
    .loading-bar::before {
      content:""; position:absolute; left:-40%; top:0;
      height:100%; width:40%; background:#ef4444;
      animation: slide 1s infinite ease-in-out;
    }
    @keyframes slide {
      0%   { left:-40%; width:30%; }
      50%  { left:50%; width:40%; }
      100% { left:100%; width:30%; }
    }

    @keyframes fadeOut { from{opacity:1;} to{opacity:0;} }
    .fade-out { animation:fadeOut 1s ease forwards; }

    @keyframes fadeIn { from{opacity:0;transform:translateY(10px);} to{opacity:1;transform:translateY(0);} }
    .animate-fade-in { animation:fadeIn 0.3s ease-out; }
  </style>
</head>
<body>

  <!-- Splash screen -->
  <div id="splash">
    <h1>Loading...</h1>
    <div class="loading-bar"></div>
  </div>

  <!-- Alerts -->
  <div id="alert-container" class="fixed bottom-4 right-4 flex flex-col space-y-3 z-50"></div>

  <!-- Navbar -->
  <nav class="bg-gray-800 p-4 flex space-x-4">
    <button onclick="switchTab('manage')" class="text-white">Manage Webhooks</button>
    <button onclick="switchTab('editor')" class="text-white">Editor</button>
    <button onclick="switchTab('send')" class="text-white">Send</button>
  </nav>

  <!-- Manage -->
  <div id="manage" class="tab active p-6">
    <h2 class="text-xl mb-2">Webhook Manager</h2>
    <form onsubmit="event.preventDefault(); saveWebhook();" class="flex flex-wrap gap-2">
      <input id="webhookName" placeholder="Name" class="p-2 rounded bg-gray-700 text-white">
      <input id="webhookUrl" placeholder="Webhook URL" class="p-2 rounded bg-gray-700 text-white w-96">
      <button type="submit" class="bg-blue-600 text-white px-3 py-2 rounded">Save</button>
    </form>
    <ul id="webhookList" class="mt-4 space-y-2"></ul>
  </div>

  <!-- Editor -->
  <div id="editor" class="tab p-6">
    <h2 class="text-xl mb-2">Message Editor</h2>
    <div id="editorBox" class="bg-gray-800"></div>
  </div>

  <!-- Send -->
  <div id="send" class="tab p-6">
    <h2 class="text-xl mb-2">Send Message</h2>
    <form onsubmit="event.preventDefault(); sendMessage();" class="flex gap-2">
      <select id="selectWebhook" class="p-2 rounded bg-gray-700 text-white"></select>
      <button type="submit" class="ml-2 bg-green-600 text-white px-3 py-2 rounded">Send</button>
    </form>
  </div>

  <script>
    // Alerts
    function showAlert(type,message){
      const c=document.getElementById("alert-container");
      let color="",icon="";
      if(type==="success"){color="bg-green-100 border-green-500 text-green-700";icon="✅";}
      else if(type==="error"){color="bg-red-100 border-red-500 text-red-700";icon="❌";}
      else if(type==="warning"){color="bg-yellow-100 border-yellow-500 text-yellow-700";icon="⚠️";}
      const alert=document.createElement("div");
      alert.className=`flex items-center p-3 border-l-4 rounded shadow ${color} animate-fade-in`;
      alert.innerHTML=`<div class="mr-2">${icon}</div><div>${message}</div>`;
      c.appendChild(alert); setTimeout(()=>alert.remove(),4000);
    }

    // Tabs
    function switchTab(tabId){
      document.querySelectorAll('.tab').forEach(t=>t.classList.remove('active'));
      document.getElementById(tabId).classList.add('active');
    }

    // Cookies
    function setCookie(name,value,days=365){
      let d=new Date(); d.setTime(d.getTime()+days*24*60*60*1000);
      document.cookie=`${name}=${encodeURIComponent(value)};expires=${d.toUTCString()};path=/`;
    }
    function getCookie(name){
      let m=document.cookie.match(new RegExp('(^| )'+name+'=([^;]+)'));
      return m?decodeURIComponent(m[2]):null;
    }

    // Webhooks
    function loadWebhooks(){
      const data=getCookie("webhooks"); let arr=data?JSON.parse(data):[];
      const list=document.getElementById("webhookList"); list.innerHTML="";
      const sel=document.getElementById("selectWebhook"); sel.innerHTML="";
      arr.forEach((w,i)=>{
        const li=document.createElement("li");
        li.className="flex justify-between bg-gray-700 p-2 rounded";
        li.innerHTML=`<span>${w.name}</span><button onclick="deleteWebhook(${i})" class="text-red-400">Delete</button>`;
        list.appendChild(li);
        let opt=document.createElement("option"); opt.value=w.url; opt.text=w.name; sel.add(opt);
      });
    }
    function saveWebhook(){
      const n=document.getElementById("webhookName").value.trim();
      const u=document.getElementById("webhookUrl").value.trim();
      if(!n||!u){showAlert("warning","Fill all fields!");return;}
      let arr=JSON.parse(getCookie("webhooks")||"[]"); arr.push({name:n,url:u});
      setCookie("webhooks",JSON.stringify(arr)); loadWebhooks();
      document.getElementById("webhookName").value="";
      document.getElementById("webhookUrl").value="";
      showAlert("success","Webhook saved");
    }
    function deleteWebhook(i){
      let arr=JSON.parse(getCookie("webhooks")||"[]"); arr.splice(i,1);
      setCookie("webhooks",JSON.stringify(arr)); loadWebhooks();
      showAlert("warning","Webhook deleted");
    }

    // Send message
    function sendMessage(){
      const sel=document.getElementById("selectWebhook");
      if(!sel.value){showAlert("warning","No webhook selected!");return;}
      const content=quill.root.innerHTML;
      fetch(sel.value,{
        method:"POST",
        headers:{"Content-Type":"application/json"},
        body:JSON.stringify({text:content})
      })
      .then(r=>r.ok?showAlert("success","Message sent!"):showAlert("error","Webhook failed"))
      .catch(()=>showAlert("error","Send failed"));
    }

    // Init
    let quill;
    window.addEventListener("load",()=>{
      showAlert("warning","Auth system disabled");
      quill=new Quill('#editorBox',{theme:"snow"});
      loadWebhooks();
      const splash=document.getElementById("splash");
      setTimeout(()=>{
        splash.classList.add("fade-out");
        setTimeout(()=>splash.remove(),1000);
      },3000);
    });
  </script>
</body>
</html>
